<script>
  section = {
    $cell:true,
    $type: "section",
    $components:[
      {$type:"div",class:"container-fluid",$components:[
        {$type:"h1",$text:"Wiki Viewer"}, 
        {$type:"article",class:"search-position",$components:[
          {$type:"p",class:"search-icon",$components:[
            {$type:"input", name:"search",id:"search",type:"search"}
          ]}
        ]},
        {$type:"article",class:"random",$components:[
          {$type:"a",href="https://en.wikipedia.org/wiki/Special:Random", target:"_blank",$components:[
            {$type:"button",class:"btn btn-primary",$text:"RANDOM!"},
            {$type:"article",class:"results"}
          ]}
        ]}
      ]}
    ]
  }
  
  var arrResults = [];
var html = '';

// Create structure for the data
function Result(title, snippet) {
  this.title = title;
  this.snippet = snippet;
}

function search() {
  // Use Ajax to handle things
  $.ajax({
    url: 'https://en.wikipedia.org/w/api.php?action=query&list=search&format=json&srsearch=' + $('#search').val(),
    dataType: 'jsonp',
    type: 'POST',
    headers: {
      'Api-User-Agent': 'Example/1.0'
    },
    success: function(data) {

      // First we clear the children from our class to make sure no previous results are showing.
      $('.results').empty();

      // Then we also clear the array with the results before providing new information.
      arrResults.length = 0;
      var resArr = data.query.search;

      //For each result, generate the html data.
      for (var result in resArr) {if (window.CP.shouldStopExecution(1)){break;}
        arrResults.push(new Result(resArr[result].title, resArr[result].snippet));
        html =  + resArr[result].title + '"target="_blank"><h3>' + resArr[result].title + '</h3></a><p>' + resArr[result].snippet + '</p></div>';

        // Displays the elements to the page
        $('.results').append(html);
      }
window.CP.exitedLoop(1);

    }
  });

  // This will handle when to display results based on the searc bar.
  if ($('#search').val().length > 0) {
    $('.articles').css('display', 'none');

  } else if ($('#search').val().length < 1) {
    // display everything again
    $('.articles').css('display', 'block');
  }

  // This make thigns tick with each key stroke
  $('#search').unbind('keyup');
  $('#search').keyup(function() {
    search();
  });
} 

$('#search').keyup(function() {
  search();
});
</script>

<footer>
  <p>Copyright Â© Rafael J. Rodriguez 2015. All Rights Reserved</p>
  <p>
    <a href="mailto:rafase282@gmail.com">
      <i class="fa fa-envelope fa-fw"></i>
    </a>
    <a href="https://github.com/Rafase282" target='_blank'>
      <i class="fa fa-github fa-fw"></i>
    </a>
    <a href="https://www.linkedin.com/in/rafase282" target='_blank'>
      <i class="fa fa-linkedin"></i>
    </a>
    <a href="https://codepen.io/Rafase282" target='_blank'>
      <i class="fa fa-codepen"></i>
    </a>
    <a href="https://rafase282.wordpress.com/" target='_blank'>
      <i class="fa fa-wordpress"></i>
    </a>
    <a href="https://www.freecodecamp.com/rafase282" target='_blank'>
    (<i class="fa fa-fire fa-fw"></i>)
  </a>
  </p>
</footer>